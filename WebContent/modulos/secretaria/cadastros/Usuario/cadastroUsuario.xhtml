<!DOCTYPE html>
<h:html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://xmlns.jcp.org/jsf/html"
 	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	
	<ui:composition template="/resources/templates/sisEducar/menuPrincipal.xhtml">
		<ui:define name="barraNavegacao">
			<li>
				<i class="ace-icon glyphicon glyphicon-floppy-disk"/>Cadastros
			</li>
			<li class="active">
				<i class="ace-icon glyphicon glyphicon-user"/>Usuário 
			</li>
		</ui:define>

		<ui:define name="scriptConteudo">			
			<div class="page-content">
				<div class="page-header">
					<h1>
						Cadastro
						<small>
							<i class="ace-icon fa fa-angle-double-right"></i>
							Cadastro de Usuários
						</small>
					</h1>
				</div>
				
				<div class="row">
					<div class="col-sm-12">
						<h:form id="formPesquisar" prependId="false">
							<!-- Modal - Busca -->
							<div id="myModal" class="modal fade" role="dialog">
								<div class="modal-dialog">
									<!-- Modal content-->
									<div class="modal-content">
										<div class="modal-header">
											<button type="button" class="close" data-dismiss="modal"></button>
											<h3 class=" smaller lighter blue">Buscar usuário(s) cadastrado(s)</h3>
										</div>
										<div class="modal-body">
											<div class="form-group">
												<div>
													<output>CPF</output>
													<span class="block input-icon input-icon-right">
														<h:inputText type="text" styleClass="form-control cpf" value="#{usuarioServlet.cpfPesquisar}">
															<f:converter converterId="converter.CPF"/>
														</h:inputText>
														<i class="ace-icon fa fa-credit-card"></i>
													</span>
												</div>
												
												<div class="">
														<output>Email</output>
														<span class="block input-icon input-icon-right"> 
														<h:inputText
															type="text" class="form-control"
															value="#{usuarioServlet.emailPesquisar}" maxlength="11">
														</h:inputText>
														<i class="ace-icon fa fa-user"></i>
													</span>
												</div>
											</div>

											<div class="table-responsive">
												<p:dataTable id="tablePesquisar" tableStyleClass="table table-hover"
													value="#{usuarioServlet.usuariosCadastrados}"
													selection="#{usuarioServlet.usuarioCadastradoSelecionado}"
													var="value" rowKey="#{value.pkUsuario}"
													scrollable="true" scrollHeight="100"
													emptyMessage="Clique no botão pesquisar para buscarmos as informações">
													<p:column selectionMode="single" style="width:6%"
														styleClass="ace">
													</p:column>
													<p:column headerText="CPF">
										                #{value.cpfcnpj}
										            </p:column>
													<p:column headerText="Usuário">
										                #{value.nome}
										            </p:column>
													<p:column headerText="Email">
										                #{value.email}
										            </p:column>
												</p:dataTable>
											</div>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-white btn-info btn-round" data-dismiss="modal">
												Fechar
											</button>
											<h:commandLink id="btEditar" class="btn btn-white btn-success btn-round"> 
												<span class="bigger-110">Editar</span>	
												<f:ajax event="click" listener="#{usuarioServlet.editar}" render=":formCadastroUsuario" execute=":formPesquisar" resetValues="true"/>
											</h:commandLink>
											<h:commandLink type="submit" class="btn btn-white btn-success btn-round"> 
												<span class="bigger-110">Pesquisar</span>	
												<i class="ace-icon fa fa-arrow-right icon-on-right"></i>
												<f:ajax event="click" listener="#{usuarioServlet.pesquisar}" render=":formPesquisar:tablePesquisar" execute=":formPesquisar" resetValues="true"/>
											</h:commandLink>	
										</div>
									</div>
								</div>
							</div><!-- FIM - Modal - Busca -->
						</h:form>
						<h:form id="formCadastroUsuario">
							<div class="clearfix form-actions">
								<h3 class="header smaller lighter blue">Informações Principais
									<button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal">
										<i class="menu-icon fa fa-search"/>
									</button>
								</h3>
								<div class="form-group">
								

								<div class="col-xs-12 col-sm-4">
										<div>
											<output>CPF</output>
											<span class="block input-icon input-icon-right">
												<h:inputText type="text" styleClass="form-control cpf" value="#{usuarioServlet.usuario.cpfcnpj}" required="true"
												requiredMessage="#{mensagens['mensagem.requerido.cpf']}" >
													<p:ajax event="change" listener="#{usuarioServlet.buscarInformacoesPessoaVinculada}" update="nomePessoa"/>
													<f:validator validatorId="validar.CpfValidator"/>
													<f:converter converterId="converter.CPF"/>
												</h:inputText>
												<i class="ace-icon fa fa-credit-card"></i>
											</span>
										</div>
									</div>
									<div class="col-xs-12 col-sm-8">
										<h:outputLabel value="Nome"/>
										<div>
											<h:inputText type="text" id="nomePessoa" class="col-sm-12"	value="#{usuarioServlet.nomePessoaVinculada}" disabled="true"/>
										</div>
									</div>
									<div class="col-xs-12 col-sm-12">
										<div>
											<output>Nome de Usuário</output>
											<span class="block input-icon input-icon-right">
												<h:inputText type="text" class="form-control" value="#{usuarioServlet.usuario.nome}" maxlength="11" required="true"
												requiredMessage="#{mensagens['mensagem.requerido.usuario']}"></h:inputText>
												<i class="ace-icon fa fa-user"></i>
											</span>
										</div>
									</div>
									<div class="col-xs-12 col-sm-6">
										<div>
											<output>Email</output>
											<span class="block input-icon input-icon-right">
												<h:inputText type="text" class="form-control" value="#{usuarioServlet.usuario.email}" maxlength="50" required="true"
												requiredMessage="#{mensagens['mensagem.requerido.email']}"></h:inputText>
												<i class="ace-icon fa fa-envelope"></i>
											</span>
										</div>
									</div>
									
									<div class="col-xs-12 col-sm-6">
										<div>
											<output>Confirmação de Email</output>
											<span class="block input-icon input-icon-right">
												<h:inputText type="text" class="form-control" value="#{usuarioServlet.usuario.confirmarEmail}" maxlength="50" required="true"
												requiredMessage="#{mensagens['mensagem.requerido.confirmacaoEmail']}"></h:inputText>
												<i class="ace-icon fa fa-envelope"></i>
											</span>
										</div>
									</div>
									<div class="col-xs-12 col-sm-6">
										<div>
											<output>Senha</output>
											<span class="block input-icon input-icon-right">
												<h:inputSecret type="text" class="form-control" value="#{usuarioServlet.usuario.senha}" maxlength="11" required="true"
												requiredMessage="#{mensagens['mensagem.requerido.senha']}"></h:inputSecret>
												<i class="ace-icon fa fa-lock"></i>
											</span>
										</div>
									</div>
									<div class="col-xs-12 col-sm-6">
										<div>
											<output>Confirmação de Senha</output>
											<span class="block input-icon input-icon-right">
												<h:inputSecret type="text" class="form-control" value="#{usuarioServlet.usuario.confirmarSenha}" maxlength="11" required="true"
												requiredMessage="#{mensagens['mensagem.requerido.confirmacaoSenha']}"></h:inputSecret>
												<i class="ace-icon fa fa-lock"></i>
											</span>
										</div>
									</div>
								</div>
								
								<!-- Este campo estará escondido para armazenar o genero selecionado -->
								<input id="inputGeneroAux" name="inputGeneroAux" class="hidden"/>
								<div class="col-xs-12 col-sm-6">
									<div class="control-group">
										<output>Gênero</output>
										<div class="inline">
											<label>
												<input id="inputGeneroMasculino" checked="checked" name="form-field-radio" type="radio" class="ace" onclick="atualizarGenero('masculino')">
												</input>
												<span class="lbl">Masculino</span>
											</label>
											
											<label>
												<input id="inputGeneroFeminino" name="form-field-radio" type="radio" class="ace" onclick="atualizarGenero('feminino')"/>
												<span class="lbl">Feminino</span>
											</label>
										</div>
									</div>
								</div>
							</div>
							
							<!-- PERMISSÕES -->
							<div class="clearfix form-actions">
								<h3 class="header smaller lighter blue">Permissões</h3>
								
								<div class="table-responsive">
									<p:dataTable tableStyleClass="table table-hover" value="#{usuarioServlet.permissoes}" selection="#{usuarioServlet.permissoesSelecionadas}" var="value" rowKey="#{value.pkPermissao}">
							            <p:column selectionMode="multiple" style="width:2%" styleClass="ace"/>
							            <p:column headerText="Nome da Tela">
							                #{value.nome}
							            </p:column>
							            <p:column headerText="Tipo da Tela">
							                #{value.nomeSubMenu}
							            </p:column>
							            <p:column headerText="Módulo">
							                #{value.nomeModulo}
							            </p:column>
							        </p:dataTable>
								</div>
							</div>
								
							<div class="col-xs-12 col-sm-6" id="default-buttons">
								<button type="reset" class="btn btn-white btn-info btn-round">
									<i class="ace-icon fa fa-file"/>
									<span class="bigger-110">Novo</span>
								</button>
								
								<h:commandLink type="submit" id="btRegistrar" class="btn btn-white btn-success btn-round"> 
									<span class="bigger-110">Registrar</span>	
									<i class="ace-icon fa fa-arrow-right icon-on-right"></i>
									<p:ajax event="click" listener="#{usuarioServlet.cadastrarUsuario}" update=":formCadastroUsuario" process=":formCadastroUsuario"/>
								</h:commandLink>	
							</div>
						</h:form>
					</div>
				</div>
			</div>
		</ui:define>
		<ui:define name="scriptPagina">
			<script src="${facesContext.externalContext.requestContextPath}/resources/templates/ace/assets/js/jquery.dataTables.min.js"></script>
			<script src="${facesContext.externalContext.requestContextPath}/resources/templates/ace/assets/js/jquery.dataTables.bootstrap.js"></script>
			<script src="${facesContext.externalContext.requestContextPath}/modulos/secretaria/cadastros/Usuario/cadastroUsuario.css"/>
			<script src="${facesContext.externalContext.requestContextPath}/modulos/secretaria/cadastros/Usuario/cadastroUsuario.js"/>
			<script src="${facesContext.externalContext.requestContextPath}/resources/templates/ace/assets/js/jquery.maskedinput.min.js"/>
		</ui:define>
	</ui:composition>
</h:html>